<!--pages/cart/cart.wxml-->
<view class="container">
    <block wx:if="{{!nodata}}">
        <view class="address" wx:if="{{defaultAddress}}" bindtap="onAddressTap">
            <image src="/images/location_icon@2x.png"></image>
            <text>{{defaultAddress.detailed}}</text>
        </view>
        <view class="no-address" bindtap="addAddress" wx:if="{{!defaultAddress}}" bindtap="addAdress">
            <image src="/images/tianjia@2x.png"> </image>
            <text>新增地址</text>
        </view>
    </block>

    <view class="cart-list">
        <block wx:for="{{cartList}}" wx:key="index" wx:if="{{!nodata}}">
            <view class="cart-item flex-between" data-shoppingid="{{item.shopingId}}">
                <view class="cart-item-radio" catchtap="onRadioTap" data-check="{{item.check}}"
                    data-shopingid="{{[item.shopingId]}}">
                    <radio checked="{{item.check}}" color="#38D092"
                        data-money="{{(item.unitPrice / 100) * item.number }}" />
                </view>
                <view class="cart-item-img" data-typeId="{{item.typeId}}" bindtap="onCartTap">
                    <image src="{{imgBaseUrl + item.imgurl}}"></image>
                </view>
                <view class="cart-item-desc">
                    <view class="title flex-between">
                        <text>{{item.title}}</text>
                        <view class="icon" data-shopingid="{{item.shopingId}}" bindtap="delShoppingCart">
                            <image src="/images/delete@2x.png"></image>
                        </view>
                    </view>
                    <view class="desc" data-typeId="{{item.typeId}}" bindtap="onCartTap">
                        {{item.represent}}
                    </view>
                    <view class="parts" bindtap="onPartTap" data-parts="{{item}}" data-shopingid="{{item.shopingId}}">
                        {{item.title + item.power}}
                        <image src="/images/gengduo_gonggao@2x.png"></image>
                    </view>
                    <view class="money flex-between">
                        <view class="price">
                            ¥{{(item.unitPrice / 100) }}
                        </view>
                        <view class="count flex-between">
                            <image src="/images/jian@2x.png" data-shopingid="{{item.shopingId}}" bindtap="onReduceTap">
                            </image>
                            <text>{{item.number}}</text>
                            <image src="/images/jia@2x.png" data-shopingid="{{item.shopingId}}" bindtap="onIncreaseTap">
                            </image>
                        </view>
                    </view>
                </view>
            </view>
        </block>

        <view class="nodata" wx:if="{{nodata}}">
            <image src="/images/cart_nodata@2x.png"></image>
            <view class="nodata-text">购物车还没有商品~</view>
        </view>
    </view>
</view>
<view class="fixed-bottom-btns flex-between" wx:if="{{!nodata}}">
    <label class="check-all" bindtap="onRadioTap" data-shopingid="{{shopId}}" data-check="{{allCheck == 1}}">
        <radio checked="{{allCheck == 1}}" color="#38D092" />全选
    </label>
    <view class="total-price">
        总计
        <text>¥{{totalPrice}}</text>
    </view>
    <view class="buy" bindtap="onBuyTap">结算({{totlaCount}})</view>
</view>

<view class="model-public-c" wx:if="{{showAddressModel}}">
    <view class='address-c animated {{showAddressModel ?"fadeInUp":""}}'>
        <image bindtap="closedModel" class="closed-btn" src="../../images/close.png" />
        <view class="address-title">配送至</view>
        <item-address binddetailAddress="detailAddress" addresslist="{{addresslist}}"
            defaultAddress="{{defaultAddress}}"></item-address>
    </view>
</view>

<view class="model-public-c" wx:if="{{showPartsModel}}">
    <view class='address-c animated {{showPartsModel ?"fadeInUp":""}}'>
        <image bindtap="closedPartsModel" class="closed-btn" src="../../images/close.png" />
        <view class="product-item">
            <view wx:for="{{productDetail}}" wx:key="index" wx:if="{{item.check}}">
                <image class="product-item-img" src="{{imgBaseUrl+item.photo1}}"></image>
            </view>


            <view class="product-item-right">
                <view class="product-item-price"> <text>¥</text>
                    {{price}}
                </view>
                <block wx:for="{{productDetail}}" wx:key="index" wx:for-item="item">
                    <view class="product-item-title" wx:if="{{item.check}}">已选：{{item.name}}</view>
                </block>
                <view class="product-item-area">面积：{{heatingArea}}</view>
            </view>


        </view>
        <view class="parts">
            <scroll-view class="scroll-c" scroll-y="{{true}}">
                <view class="parts-item">
                    <view class="parts-title">{{productDetail[0].titleLabel}}</view>
                    <view class="parts-option">
                        <block wx:for="{{productDetail}}" wx:key="index">
                            <view
                                class="parts-option-item big {{item.check? 'selected':''}} {{!item.stockStatus?'stock':''}}"
                                bindtap="onModelTap" data-stock="{{item.stockStatus}}" data-typeId="{{item.typeId}}">
                                {{item.name}}
                            </view>
                        </block>
                    </view>
                </view>

                <block wx:for="{{productDetail}}" wx:if="{{x.parts && x.check}}" wx:key="index" wx:for-item="x">
                    <view class="parts-item">
                        <view class="parts-title">{{x.parts.titleLabel}}</view>
                        <view class="parts-option">
                            <block wx:for="{{x.parts.parts}}" wx:key="index" wx:for-item="y">
                                <view
                                    class="parts-option-item big {{y.check? 'selected':''}} {{!y.stockStatus?'stock':''}}"
                                    bindtap="onPowerTap" data-level="second" data-partsId="{{y.partsId}}"
                                    data-price="{{y.money / 100}}" data-heatingArea="{{y.heatingArea}}"
                                    data-stock="{{y.stockStatus}}">
                                    {{y.power}}
                                </view>
                            </block>
                        </view>
                    </view>
                </block>

                <block wx:for="{{productDetail}}" wx:if="{{x.parts && x.check}}" wx:key="index" wx:for-item="x">
                    <block wx:for="{{x.parts.parts}}" wx:if="{{y.parts && y.check}}" wx:key="index" wx:for-item="y">
                        <view class="parts-item">
                            <view class="parts-title">{{y.parts.titleLabel}}</view>
                            <view class="parts-option">
                                <block wx:for="{{y.parts.parts}}" wx:key="index" wx:for-item="z">
                                    <view
                                        class="parts-option-item big {{z.check? 'selected':''}} {{!z.stockStatus?'stock':''}}"
                                        bindtap="onPowerTap" data-level="third" data-partsId="{{z.partsId}}"
                                        data-price="{{z.money / 100}}" data-heatingArea="{{z.heatingArea}}"
                                        data-stock="{{z.stockStatus}}">
                                        {{z.power}}
                                    </view>
                                </block>
                            </view>
                        </view>
                    </block>
                </block>

            </scroll-view>
        </view>
        <view class="btn btn-block" bindtap="onSureTap">
            确定
        </view>
    </view>
</view>